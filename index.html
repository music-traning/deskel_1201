<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="デッサン用スケール（デスケル）アプリ。スマホのカメラで構図を確認、グリッド表示、明度変更ができます。美大受験や絵画制作に最適。完全無料・登録不要ですぐ使えます。">

  <meta property="og:title" content="Deskel Pro - デッサン用構図確認アプリ">
  <meta property="og:description" content="スマホをかざすだけでデスケルに。グリッド表示・明度変更・回転機能付き。美大受験や絵画の構図決めに。">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://deskel-1201.vercel.app/">
  <meta property="og:image" content="https://deskel-1201.vercel.app/icon.png">
  <meta name="twitter:card" content="summary">
  <title>Deskel Pro (v3)</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="icon" href="icon.png">
  <meta name="theme-color" content="#000000">
  <link rel="preconnect" href="https://esm.sh">
  <link rel="stylesheet" href="style.css">

  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self'; 
    script-src 'self' https://esm.sh; 
    connect-src 'self' https://vitals.vercel-analytics.com https://esm.sh; 
    img-src 'self' data: https://deskel-1201.vercel.app;
    media-src 'self';
    style-src 'self' 'unsafe-inline';
    font-src 'self';
    object-src 'none';
    base-uri 'self';
  ">
</head>

<body>

  <button id="btn-toggle-ui" aria-label="没入モード切替">👁️</button>

  <div id="top-bar">
    <button id="btn-help" aria-label="ヘルプ">?</button>
    <div class="top-right-group">
      <button id="btn-lang" class="status-btn">🇯🇵 Japan</button>
    </div>
  </div>

  <div class="video-container" id="touch-area">
    <div id="transform-wrapper">
      <video id="camera-video" autoplay playsinline muted></video>
      <img id="imported-image" style="display:none;" draggable="false" alt="">
    </div>
  </div>

  <div id="overlay-layer">
    <div id="guide-frame" class="grid-4x4"></div>
  </div>

  <div class="ui-container" id="main-ui">
    <div class="zoom-control">
      <span>－</span>
      <input type="range" id="zoom-slider" min="1.0" max="3.0" step="0.01" value="1.0" aria-label="ズーム倍率">
      <span>＋</span>
    </div>

    <div class="main-actions">
      <button id="btn-grid-type" class="tool-btn" aria-label="グリッド切り替え">▦</button>
      <button id="btn-grid-color" class="tool-btn" aria-label="グリッド色変更">🎨</button>
      <button id="btn-rotate" class="tool-btn" aria-label="画面回転">🔄</button>

      <button id="btn-camera" class="size-btn-static" style="background: rgba(60,60,60,0.9);">📷 Camera</button>
      <button id="btn-import" class="size-btn-static" style="background: rgba(60,60,60,0.9);">📁 Import</button>
      <input type="file" id="file-input" accept="image/*" style="display: none;" aria-label="画像ファイルを選択">
    </div>

    <button id="btn-open-size-panel" aria-label="サイズパネルを開く">
      <span id="current-size-label">サイズを選択</span>
    </button>

    <button id="shutter-btn" aria-label="撮影"></button>
  </div>

  <div id="size-panel">
    <div class="panel-header">
      <span id="text-size-header">キャンバスサイズ</span>
      <button class="panel-close-btn" aria-label="閉じる">×</button>
    </div>
    <div class="size-grid" id="panel-grid-container"></div>
  </div>

  <div id="save-modal">
    <div class="modal-box">
      <h3 id="text-save-title">撮影しました</h3>
      <img id="preview-img" src="" alt="撮影された画像のプレビュー">
      <p id="text-save-desc" style="text-align:center; font-size:12px; color:#aaa; margin-bottom:15px;">
        保存方法を選んでください</p>
      <div style="display:flex; justify-content:center; flex-wrap:wrap;">
        <button id="btn-main-save" class="btn-download"
          style="background:#00d2ff; color:black; width:100%; padding:15px;">
          💾 画像を保存・共有
        </button>
      </div>
      <button id="btn-close-save" class="btn-cancel">閉じる</button>
    </div>
  </div>

  <div id="help-modal">
    <div class="modal-box">
      <h3 id="text-help-title">使い方</h3>
      <div id="help-content-area" class="help-content"></div>
      <button id="btn-close-help" class="btn-cancel">閉じる</button>
    </div>
  </div>

  <div id="onboarding-overlay" style="display:none;">
    <div class="onboarding-content">
      <div class="ob-step step-center">
        <div class="ob-icon">👆</div>
        <p>2本指で<br>拡大・縮小</p>
      </div>
      <div class="ob-step step-bottom">
        <div class="ob-arrow">⬇</div>
        <p>ツールバーで<br>グリッド・色を変更</p>
      </div>
      <button class="ob-btn-start">はじめる</button>
    </div>
  </div>

  <canvas id="photo-canvas"></canvas>

  <script type="module" src="script.js"></script>
</body>
</html>